(this.webpackJsonpsphere=this.webpackJsonpsphere||[]).push([[0],{53:function(e,t,n){},55:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var r=n(6),o=n.n(r),i=n(45),c=n.n(i),a=(n(52),n(53),n(10)),u=n(15),s=n(9),l=n(46),f=n(30),b=n(61),d=n(64),j=n(65),O=n(62),h=n(63),p=n(17),m=n(31),v=n(41),x=n(25),w=n(0),y=n(40);n(55);function k(e){var t=Object(r.useState)(!1),n=Object(a.a)(t,2),o=n[0],i=n[1],c=Object(r.useCallback)((function(t){t.keyCode===e&&i(!0)}),[e]),u=Object(r.useCallback)((function(t){t.keyCode===e&&i(!1)}),[e]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",c),window.addEventListener("keyup",u),function(){window.removeEventListener("keydown",c),window.removeEventListener("keyup",u)}}),[c,u]),o}var g=n(12),S=["rgb(249, 65, 68)","rgb(243, 114, 44)","rgb(248, 150, 30)","rgb(249, 199, 79)","rgb(144, 190, 109)","rgb(67, 170, 139)","rgb(87, 117, 144)"];function E(e){return S[e%S.length]}var I=function(e,t){var n=new w.Vector3(0,0,3),r=new w.Vector3(0,0,-1);return function(e,t,n){return{ballId:e,position:t,velocity:n,color:E(e)}}(e,n.applyQuaternion(t.orientation),r.applyQuaternion(t.orientation).multiplyScalar(2))},M=function(e){var t=.2,n=Math.floor(2*Math.PI/(.4+t)),r=Math.floor(Math.random()*n),o=Math.floor(Math.random()*n);return function(e,t){return{brickId:e,orbitOffset:t,color:E(e)}}(e,new w.Vector3(r*(.4+t)+.1,o*(.4+t)+.1,1.5))},A=Object(y.a)((function(e,t){return{player:{orientation:new w.Quaternion},balls:Object(v.a)(),nextBallId:0,bricks:Object(v.b)(),nextBrickId:0,outlineSelection:Object(v.c)(),actions:{addBall:function(){return e((function(e){var t=I(e.nextBallId,e.player);return{balls:e.balls.push(t).slice(-3),nextBallId:e.nextBallId+1}}))},removeBrick:function(t){return e((function(e){return{bricks:e.bricks.delete(t)}}))},addRandomBrick:function(){return e((function(e){var t=M(e.nextBrickId);return{bricks:e.bricks.set(t.brickId,t),nextBrickId:e.nextBrickId+1}}))},updateBrick:function(t,n){return e((function(e){return{bricks:e.bricks.update(t,(function(e){return Object(s.a)(Object(s.a)({},e),n)}))}}))},movePlayer:function(t,n,r,o,i){return e((function(e){var c=t*(i?-1:o?1:0),a=new w.Vector3(-1,0,0),u=(new w.Quaternion).setFromAxisAngle(a,c),s=t*(n?-1:r?1:0),l=new w.Vector3(0,1,0),f=(new w.Quaternion).setFromAxisAngle(l,s);return{player:{orientation:e.player.orientation.clone().multiply(u).multiply(f)}}}))},addOutlineSelection:function(t){return e((function(e){return{outlineSelection:e.outlineSelection.add(t)}}))},removeOutlineSelection:function(t){return e((function(e){return{outlineSelection:e.outlineSelection.remove(t)}}))},resetGame:function(){var e=t().actions.addRandomBrick;Object(u.a)(Array(16)).forEach(e)}}}}));function B(){var e=Object(f.c)((function(){return{args:1,mass:1,type:"Static"}})),t=Object(a.a)(e,1)[0];return Object(g.jsxs)("mesh",{position:[0,0,0],ref:t,receiveShadow:!0,children:[Object(g.jsx)("sphereGeometry",{args:[1,32,32]}),Object(g.jsx)("meshToonMaterial",{attach:"material",color:"hotpink"})]})}function C(){var e=A((function(e){return e.actions.addOutlineSelection})),t=A((function(e){return e.actions.removeOutlineSelection})),n=k(x.c),o=k(x.d),i=k(x.f),c=k(x.a),u=Object(r.useRef)(null),s=Object(r.useRef)(null),O=A((function(e){return e.player})),h=A((function(e){return e.actions.movePlayer})),m=A((function(e){return e.actions.addBall})),v=[1,.2,.1],y=new w.Vector3(0,0,4),S=Object(f.b)((function(){return{args:v,mass:1,position:y.toArray(),rotation:[Math.PI,0,0],type:"Static",onCollide:C}})),E=Object(a.a)(S,2),I=E[0],M=E[1],B=Object(l.useSpring)({to:{distort:0},from:{distort:.4},config:{duration:1500}}).distort,C=Object(r.useCallback)((function(e){return B.reset()}),[B]);return function(e,t){var n=Object(r.useCallback)((function(n){n.keyCode===e&&t()}),[e,t]);Object(r.useEffect)((function(){return window.addEventListener("keypress",n),function(){window.removeEventListener("keypress",n)}}),[n])}(x.e,m),Object(p.b)((function(e,t){h(t,n,o,i,c);var r=(new w.Euler).setFromQuaternion(O.orientation),a=y.clone().applyQuaternion(O.orientation);M.rotation.copy(r),M.position.copy(a)})),Object(r.useEffect)((function(){var e=I.current;return e.addEventListener("collide",C),function(){return e.removeEventListener("collide",C)}}),[I,C]),Object(r.useEffect)((function(){return e(I),function(){return t(I)}}),[I,e,t]),Object(g.jsx)("group",{ref:u,position:[0,0,0],children:Object(g.jsxs)(b.a,{args:v,radius:.05,smoothness:8,ref:I,receiveShadow:!0,children:[Object(g.jsx)("meshToonMaterial",{attach:"material",color:"#f3f3f3"}),Object(g.jsx)(d.a,{color:"orange",attach:"material",distort:B.get(),speed:10}),Object(g.jsx)(j.a,{makeDefault:!0,ref:s,position:[0,1,2],rotation:[-Math.PI/16,0,0]})]})})}function Q(e){var t=A((function(e){return e.balls}));return Object(g.jsx)("group",Object(s.a)(Object(s.a)({},e),{},{children:t.map((function(e){return Object(g.jsx)(L,{ball:e},e.ballId)}))}))}function L(e){var t=e.ball,n=A((function(e){return e.actions.addOutlineSelection})),o=A((function(e){return e.actions.removeOutlineSelection})),i=Object(f.c)((function(){return{args:.2,mass:1,position:t.position.toArray(),velocity:t.velocity.toArray()}})),c=Object(a.a)(i,1)[0];return Object(r.useEffect)((function(){return n(c),function(){return o(c)}}),[c,n,o]),Object(g.jsxs)("mesh",{ref:c,scale:.2,castShadow:!0,children:[Object(g.jsx)("sphereGeometry",{args:[1,16,16]}),Object(g.jsx)("meshToonMaterial",{attach:"material",color:t.color})]})}function V(){var e=A((function(e){return e.bricks}));return Object(g.jsx)("group",{children:e.valueSeq().map((function(e){return Object(g.jsx)(z,{brick:e},e.brickId)}))})}function z(e){var t=e.brick,n=A((function(e){return e.actions.addOutlineSelection})),o=A((function(e){return e.actions.removeOutlineSelection})),i=Object(r.useMemo)((function(){return function(e){var t=new w.Quaternion;t.setFromAxisAngle(new w.Vector3(1,0,0),e.x);var n=new w.Quaternion;n.setFromAxisAngle(new w.Vector3(0,1,0),e.y);var r=t.multiply(n),o=new w.Euler;return o.setFromQuaternion(r),[o,new w.Vector3(0,0,e.z).applyQuaternion(r)]}(t.orbitOffset)}),[t]),c=Object(a.a)(i,2),u=c[0],s=c[1],l=[.4,.4,.1],d=Object(f.b)((function(){return{args:l,mass:1,position:s.toArray(),rotation:u.toArray(),type:"Static"}}),void 0,[u,s]),j=Object(a.a)(d,1)[0];return Object(r.useEffect)((function(){return n(j),function(){return o(j)}}),[j,n,o]),Object(g.jsx)(b.a,{args:l,radius:.05,smoothness:8,ref:j,receiveShadow:!0,children:Object(g.jsx)("meshToonMaterial",{attach:"material",color:t.color})})}function F(){var e=A((function(e){return e.outlineSelection})),t=Object(r.useMemo)((function(){return e.toArray().filter((function(e){return void 0!==e.current}))}),[e]),n=k(x.b);return Object(g.jsx)(r.Suspense,{fallback:null,children:Object(g.jsxs)(m.a,{multisampling:0,autoClear:!1,children:[n?Object(g.jsx)(m.b,{active:!0,ratio:.85,delay:new w.Vector2(0,0)}):Object(g.jsx)(m.d,{}),Object(g.jsx)(m.c,{selection:t,edgeStrength:10,pulseSpeed:0,visibleEdgeColor:16777215,hiddenEdgeColor:2230538,blur:!1,xRay:!1,width:2048,height:2048}),Object(g.jsx)(O.a,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0}),Object(g.jsx)(m.e,{eskil:!1,offset:.1,darkness:1.1})]})})}function P(){var e=A((function(e){return e.actions.resetGame}));return Object(r.useEffect)(e,[e]),Object(g.jsxs)(p.a,{style:{backgroundColor:"#121212"},shadows:!0,children:[Object(g.jsxs)(f.a,{gravity:[0,0,0],defaultContactMaterial:{friction:0,restitution:1},children:[Object(g.jsx)("pointLight",{position:[30,10,10],castShadow:!0,"shadow-mapSize-width":4096,"shadow-mapSize-height":4096}),Object(g.jsx)("pointLight",{position:[-20,-30,5],castShadow:!0,"shadow-mapSize-width":4096,"shadow-mapSize-height":4096}),Object(g.jsx)(B,{}),Object(g.jsx)(Q,{}),Object(g.jsx)(V,{}),Object(g.jsx)(C,{})]}),Object(g.jsx)(F,{})]})}Object(h.a)({frustum:3.75,size:.005,near:9.5,samples:17,rings:11}),c.a.render(Object(g.jsx)(o.a.StrictMode,{children:Object(g.jsx)(P,{})}),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.0645b4b9.chunk.js.map